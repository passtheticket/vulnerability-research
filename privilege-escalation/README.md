# Intel(r) Management and Security Application 5.2 - User Notification Service Unquoted Service Path

Intel(r) Management and Security Application User Notification Service (v5.2) path contains spaces and is not surrounded 
by quotation marks and Windows has to guess where to find the UNS executable that starts automatically.

![alt text](https://github.com/passtheticket/vulnerability-research/blob/main/screenshots/1.png)

Windows will first consider the space at the end of the filename and interpret everything.
Using the service controller, I detected file path of user notification service. 

![alt text](https://github.com/passtheticket/vulnerability-research/blob/main/screenshots/2.png)
```
File Path: 
C:\Program Files (x86)\Common Files\Intel\Privacy Icon\UNS\UNS.exe
```
If an user has permission to write one of these  directories, mandatory level of user will be elevated as SYSTEM after Windows 7 / 8 machine is rebooted.
Privacy.exe was created with mfsvenom and served on port 80. Also, port 443 was used for reverse shell so if there is a firewall in front of target machine, 
outbound firewall rules allow 80, 443, 53 ports usually.

![alt text](https://github.com/passtheticket/vulnerability-research/blob/main/screenshots/4.png)
![alt text](https://github.com/passtheticket/vulnerability-research/blob/main/screenshots/5.png)
![alt text](https://github.com/passtheticket/vulnerability-research/blob/main/screenshots/6.png)

Exploit: https://www.exploit-db.com/exploits/49144

# Pearson Vue VTS 2.3.1911 Installer - VUEApplicationWrapper Unquoted Service Path
The Application Wrapper is the component that automates the Pearson VUE Testing System. The Wrapper is a scheduler that runs in the background on the test 
centerâ€™s server. VUEApplicationWrapper service has an unquoted service path vulnerability and insecure file permissions on "\Pearson VUE\" directory that allows 
to overwrite by everyone so that unauthorized local user can leverage privileges to VUEService user that has administrative rights.

Exploit: https://www.exploit-db.com/exploits/49143

```
#Detection of unquoted service path:

C:\Users\VUEService>wmic service get name, pathname, displayname, startmode| findstr /i "Auto" | findstr /i /v "C:\Windows\\" | findstr /i "Pearson" |findstr /i /v """
VUE Application Wrapper
VUEApplicationWrapper C:\Pearson VUE\VUE
Testing System\bin\VUEWrapper.exe
Auto

C:\Users\VUEService>sc qc VUEApplicationWrapper
[SC] QueryServiceConfig SUCCESS

SERVICE_NAME: VUEApplicationWrapper
TYPE : 10 WIN32_OWN_PROCESS
START_TYPE : 2 AUTO_START
ERROR_CONTROL : 1 NORMAL
BINARY_PATH_NAME : C:\Pearson VUE\VUE TestingSystem\bin\VUEWrapper.exe
LOAD_ORDER_GROUP :
TAG : 0
DISPLAY_NAME : VUE Application Wrapper
DEPENDENCIES : lanmanworkstation
SERVICE_START_NAME : .\VUEService


#Detection of insecure file permissions:

PS C:\Users\VUEService> Get-Acl -Path "c:\Pearson Vue\"


Directory: C:\


Path Owner Access
---- ----- ------
Pearson Vue BUILTIN\Administrators Everyone Allow FullControl...
```
