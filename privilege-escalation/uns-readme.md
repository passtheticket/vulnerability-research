# Intel(r) Management and Security Application 5.2 - User Notification Service Unquoted Service Path

Intel(r) Management and Security Application User Notification Service (v5.2) path contains spaces and is not surrounded 
by quotation marks and Windows has to guess where to find the UNS executable that starts automatically.

![alt text](https://github.com/passtheticket/vulnerability-research/blob/main/screenshots/1.png)

Windows will first consider the space at the end of the filename and interpret everything.
Using the service controller, I detected file path of user notification service. 

![alt text](https://github.com/passtheticket/vulnerability-research/blob/main/screenshots/2.png)
```
File Path: 
C:\Program Files (x86)\Common Files\Intel\Privacy Icon\UNS\UNS.exe
```
If an user has permission to write one of these  directories, mandatory level of user will be elevated as SYSTEM after Windows 7 / 8 machine is rebooted.
Privacy.exe was created with mfsvenom and served on port 80. Also, port 443 was used for reverse shell so if there is a firewall in front of target machine, 
outbound firewall rules allow 80, 443, 53 ports usually.

![alt text](https://github.com/passtheticket/vulnerability-research/blob/main/screenshots/4.png)
![alt text](https://github.com/passtheticket/vulnerability-research/blob/main/screenshots/5.png)
![alt text](https://github.com/passtheticket/vulnerability-research/blob/main/screenshots/6.png)

Exploit: https://www.exploit-db.com/exploits/49144


